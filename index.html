<script>
  const walletAddressEl = document.getElementById('wallet-address');

  // Helper: check if wallet key exists in window.cardano
  function detectWallet(walletName) {
    return window.cardano && window.cardano[walletName];
  }

  // Detect available Cardano wallets
  function getAvailableWallets() {
    if (!window.cardano) return [];
    return Object.keys(window.cardano).filter(key => {
      // Wallet keys are objects with 'enable' function
      return typeof window.cardano[key]?.enable === 'function';
    });
  }

  // Connect to a wallet by name
  async function connectWallet(walletName) {
    if (!detectWallet(walletName)) {
      alert(`‚ùó ${walletName} wallet not found. Please install it.`);
      return null;
    }
    try {
      const api = await window.cardano[walletName].enable();
      const addresses = await api.getUsedAddresses();
      walletAddressEl.textContent = `‚úÖ ${walletName} Connected: ${addresses[0]}`;
      return api;
    } catch (err) {
      alert(`‚ùå Failed to connect to ${walletName} wallet`);
      console.error(err);
      return null;
    }
  }

  // Connect Lace wallet button
  document.getElementById('connect-lace-btn').addEventListener('click', async () => {
    await connectWallet('lace');
  });

  // Connect VESPR wallet button
  document.getElementById('connect-vespr-btn').addEventListener('click', async () => {
    await connectWallet('vespr');
  });

  // Optionally show available wallets on load
  window.addEventListener('load', () => {
    const wallets = getAvailableWallets();
    if (wallets.length === 0) {
      walletAddressEl.textContent = '‚ö†Ô∏è No Cardano wallets detected on this device/browser.';
    } else {
      walletAddressEl.textContent = `üü¢ Wallets detected: ${wallets.join(', ')}`;
    }
  });
</script>
