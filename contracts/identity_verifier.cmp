contract IdentityVerifier {
  storage:
    owner: address;
    known_hashes: map<field, bool>;

  constructor() {
    owner = caller();
    known_hashes[hash("refugee001")] = true;
  }

  public function register_identity(user_id: field) {
    require(caller() == owner, "Unauthorized");
    let hash_id = hash(user_id);
    known_hashes[hash_id] = true;
  }

  public function verify_proof(public_hash: field, zk_proof: zkproof) -> bool {
    require(verify_proof(zk_proof, public_hash), "Invalid proof");
    return known_hashes[public_hash];
  }
}
